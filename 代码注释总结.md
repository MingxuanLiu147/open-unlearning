# Unlearning ä»£ç æ³¨é‡Šæ€»ç»“

æœ¬æ–‡æ¡£æ€»ç»“äº†ä¸º open-unlearning é¡¹ç›®æ·»åŠ çš„ä¸­æ–‡æ³¨é‡Šå’Œè¯´æ˜æ–‡æ¡£ã€‚

## ğŸ“ å·²æ·»åŠ æ³¨é‡Šçš„æ–‡ä»¶

### 1. è®­ç»ƒå…¥å£ - `src/train.py` âœ…

**ä¿®æ”¹å†…å®¹ï¼š**
- æ·»åŠ äº†å®Œæ•´çš„æ¨¡å—æ–‡æ¡£è¯´æ˜
- ä¸º `main()` å‡½æ•°æ·»åŠ äº†è¯¦ç»†çš„å‚æ•°è¯´æ˜
- ä¸ºæ¯ä¸ªæ­¥éª¤æ·»åŠ äº†åˆ†å—æ³¨é‡Šï¼ˆå…± 9 ä¸ªæ­¥éª¤ï¼‰
- è§£é‡Šäº† Hydra é…ç½®åŠ è½½é¡ºåº
- è¯´æ˜äº† `mode="unlearn"` çš„ç‰¹æ®Šå¤„ç†

**å…³é”®æ³¨é‡Šç‚¹ï¼š**
- Hydra è£…é¥°å™¨çš„ä½œç”¨
- é…ç½®åŠ è½½é¡ºåºï¼ˆåŸºç¡€ â†’ å®éªŒ â†’ å‘½ä»¤è¡Œï¼‰
- ForgetRetainDataset çš„æ•°æ®ç»“æ„
- è®­ç»ƒå’Œè¯„ä¼°æµç¨‹

### 2. SimNPO ç®—æ³• - `src/trainer/unlearn/simnpo.py` âœ…

**ä¿®æ”¹å†…å®¹ï¼š**
- æ·»åŠ äº† SimNPO ç®—æ³•åŸç†è¯´æ˜
- è¯¦ç»†è§£é‡Šäº†æŸå¤±å‡½æ•°çš„æ•°å­¦å…¬å¼
- ä¸ºæ¯ä¸ªå‚æ•°æ·»åŠ äº†è¯¦ç»†æ³¨é‡Š
- è§£é‡Šäº† logsigmoid å˜æ¢çš„ä½œç”¨
- è¯´æ˜äº† forget å’Œ retain æŸå¤±çš„è®¡ç®—æ–¹å¼

**å…³é”®æ³¨é‡Šç‚¹ï¼š**
- deltaã€betaã€gammaã€alpha å‚æ•°çš„å«ä¹‰å’Œå½±å“
- NLL çš„è®¡ç®—å’Œå½’ä¸€åŒ–
- logsigmoid è½¬æ¢çš„ç›´è§‚ç†è§£
- æŸå¤±ç»„åˆçš„æƒé‡ç­–ç•¥

### 3. GradDiff åŸºç±» - `src/trainer/unlearn/grad_diff.py` âœ…

**ä¿®æ”¹å†…å®¹ï¼š**
- æ·»åŠ äº† GradDiff ç®—æ³•çš„ç†è®ºè¯´æ˜
- è¯¦ç»†æ³¨é‡Šäº†å‚è€ƒæ¨¡å‹çš„å‡†å¤‡è¿‡ç¨‹
- è§£é‡Šäº† NLL å’Œ KL ä¸¤ç§ retain æŸå¤±ç±»å‹
- è¯´æ˜äº†æ¢¯åº¦ä¸Šå‡çš„åŸç†ï¼ˆå–è´Ÿå·ï¼‰

**å…³é”®æ³¨é‡Šç‚¹ï¼š**
- gamma å’Œ alpha çš„æƒé‡å¹³è¡¡
- å‚è€ƒæ¨¡å‹çš„ä½œç”¨ï¼ˆç”¨äº KL æ•£åº¦ï¼‰
- DeepSpeed æ¨¡å¼çš„ç‰¹æ®Šå¤„ç†
- æ¢¯åº¦æ–¹å‘çš„åè½¬æœºåˆ¶

### 4. ç»„åˆæ•°æ®é›† - `src/data/unlearn.py` âœ…

**ä¿®æ”¹å†…å®¹ï¼š**
- æ·»åŠ äº†å®Œæ•´çš„æ¨¡å—æ–‡æ¡£è¯´æ˜
- è¯¦ç»†è§£é‡Šäº† anchor å‚æ•°çš„ä½œç”¨
- è¯´æ˜äº†éšæœºé‡‡æ ·ç­–ç•¥çš„åŸå› 
- æä¾›äº†å…·ä½“çš„ä½¿ç”¨ç¤ºä¾‹

**å…³é”®æ³¨é‡Šç‚¹ï¼š**
- ForgetRetainDataset çš„è®¾è®¡ç†å¿µ
- anchor="forget" vs anchor="retain" çš„åŒºåˆ«
- ä¸ºä»€ä¹ˆè¦éšæœºé‡‡æ ·éé”šå®šæ•°æ®
- æ•°æ®é›†é•¿åº¦å¯¹è®­ç»ƒæ­¥æ•°çš„å½±å“

## ğŸ“š æ–°å¢æ–‡æ¡£

### 1. å®Œæ•´æŒ‡å— - `UNLEARNING_GUIDE_CN.md` âœ…

**åŒ…å«ç« èŠ‚ï¼š**

#### 1. ä»€ä¹ˆæ˜¯ Unlearning
- åº”ç”¨åœºæ™¯ï¼ˆéšç§ä¿æŠ¤ã€æ•°æ®çº é”™ç­‰ï¼‰
- æ ¸å¿ƒæŒ‘æˆ˜ï¼ˆé€‰æ‹©æ€§é—å¿˜ã€æ•ˆç‡è¦æ±‚ç­‰ï¼‰

#### 2. æ•´ä½“æ¶æ„
- æ ¸å¿ƒç»„ä»¶ç›®å½•ç»“æ„
- æ•°æ®æµå›¾ç¤º
- é…ç½®æ–‡ä»¶ç»„ç»‡

#### 3. æ‰§è¡Œæµç¨‹è¯¦è§£
- å‘½ä»¤è¡Œå¯åŠ¨æµç¨‹
- 9 ä¸ªè¯¦ç»†æ­¥éª¤è¯´æ˜
- æ¯ä¸ªæ­¥éª¤çš„ä»£ç ç¤ºä¾‹

#### 4. å‘½ä»¤è¡Œå‚æ•°è§£æ
- åŸºç¡€å‚æ•°è¡¨æ ¼
- æ•°æ®å‚æ•°è¯´æ˜
- è®­ç»ƒå™¨å‚æ•°åˆ—è¡¨
- è¯„ä¼°å’Œä¿å­˜å‚æ•°

#### 5. SimNPO ç®—æ³•åŸç†
- æ ¸å¿ƒæ€æƒ³
- æ•°å­¦å…¬å¼æ¨å¯¼
- å‚æ•°å½±å“åˆ†æè¡¨æ ¼
- ä»£ç å®ç°ç¤ºä¾‹

#### 6. å¦‚ä½•ä¿®æ”¹é…ç½®
- æ›´æ¢ Unlearning æ–¹æ³•ï¼ˆ8+ ç§æ–¹æ³•ï¼‰
- æ›´æ¢æ•°æ®é›†ï¼ˆ2 ç§æ–¹å¼ï¼‰
- æ›´æ¢è¯„ä»·æŒ‡æ ‡ï¼ˆ2 ç§æ–¹å¼ï¼‰
- è°ƒæ•´è¶…å‚æ•°ï¼ˆå­¦ä¹ ç‡ã€è½®æ•°ç­‰ï¼‰

#### 7. å¸¸è§é—®é¢˜ (FAQ)
- Q1: å¦‚ä½•æŸ¥çœ‹è®­ç»ƒè¿›åº¦ï¼Ÿ
- Q2: å¦‚ä½•æ¢å¤ä¸­æ–­çš„è®­ç»ƒï¼Ÿ
- Q3: æ˜¾å­˜ä¸è¶³æ€ä¹ˆåŠï¼Ÿ
- Q4: å¦‚ä½•è¯„ä¼°é—å¿˜æ•ˆæœï¼Ÿ
- Q5: å¦‚ä½•å¯¹æ¯”ä¸åŒæ–¹æ³•ï¼Ÿ

#### é™„å½•
- å®Œæ•´é…ç½®ç¤ºä¾‹ï¼ˆåŸºç¡€ã€åˆ†å¸ƒå¼ã€DeepSpeedï¼‰
- å‚è€ƒæ–‡çŒ®

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µè§£é‡Š

### 1. Unlearning çš„æœ¬è´¨

```
æ­£å¸¸è®­ç»ƒï¼šminimize Loss(forget) â†’ æ¨¡å‹å­¦ä¹  forget æ•°æ®
é—å¿˜è®­ç»ƒï¼šminimize -Loss(forget) â†’ æ¨¡å‹"å¿˜è®°" forget æ•°æ®
         + minimize Loss(retain) â†’ ä¿æŒ retain æ•°æ®æ€§èƒ½
```

### 2. ForgetRetainDataset çš„ä½œç”¨

```python
# æ¯æ¬¡è¿”å›ä¸€å¯¹æ•°æ®
{
    "forget": forget_sample,  # éœ€è¦é—å¿˜çš„æ•°æ®
    "retain": retain_sample   # éœ€è¦ä¿æŒçš„æ•°æ®
}

# ä½¿å¾— Trainer å¯ä»¥åœ¨ä¸€ä¸ªè®­ç»ƒå¾ªç¯ä¸­åŒæ—¶ï¼š
# - å¯¹ forget æ‰§è¡Œæ¢¯åº¦ä¸Šå‡ï¼ˆå¢åŠ æŸå¤±ï¼‰
# - å¯¹ retain æ‰§è¡Œæ­£å¸¸è®­ç»ƒï¼ˆå‡å°‘æŸå¤±ï¼‰
```

### 3. SimNPO çš„ä¼˜åŠ¿

ç›¸æ¯”ç®€å•çš„æ¢¯åº¦ä¸Šå‡ï¼ˆGradAscentï¼‰ï¼ŒSimNPO é€šè¿‡ logsigmoid å˜æ¢ï¼š

1. **æ›´ç¨³å®š**ï¼šé¿å…æ¢¯åº¦çˆ†ç‚¸
2. **æ›´æ™ºèƒ½**ï¼šNLL é«˜æ—¶è‡ªåŠ¨é™ä½æƒé‡ï¼ˆå·²ç»é—å¿˜äº†ï¼‰
3. **æ›´çµæ´»**ï¼šé€šè¿‡ beta å’Œ delta æ§åˆ¶é—å¿˜å¼ºåº¦

### 4. å‚æ•°è°ƒä¼˜æŒ‡å—

| ç›®æ ‡ | è°ƒæ•´ç­–ç•¥ |
|------|----------|
| **æ›´å¼ºçš„é—å¿˜** | å¢å¤§ `gamma`ï¼ˆ0.125 â†’ 0.5ï¼‰<br>å¢å¤§ `beta`ï¼ˆ4.5 â†’ 10.0ï¼‰<br>å¢å¤§ `delta`ï¼ˆ0.0 â†’ 0.5ï¼‰ |
| **æ›´å¥½çš„ä¿æŒ** | å¢å¤§ `alpha`ï¼ˆ1.0 â†’ 2.0ï¼‰<br>å‡å° `gamma`ï¼ˆ0.125 â†’ 0.05ï¼‰<br>ä½¿ç”¨ `retain_loss_type="KL"` |
| **æ›´å¿«æ”¶æ•›** | å¢å¤§å­¦ä¹ ç‡ï¼ˆ5e-5 â†’ 1e-4ï¼‰<br>å‡å°‘è®­ç»ƒè½®æ•°ï¼ˆ20 â†’ 10ï¼‰ |
| **æ›´ç¨³å®šè®­ç»ƒ** | å‡å°å­¦ä¹ ç‡ï¼ˆ5e-5 â†’ 1e-5ï¼‰<br>å‡å° `beta`ï¼ˆ4.5 â†’ 2.0ï¼‰<br>å¢åŠ  warmup |

## ğŸ”„ å¦‚ä½•ä¿®æ”¹é…ç½® - å¿«é€Ÿå‚è€ƒ

### æ›´æ¢æ–¹æ³•

```bash
# SimNPOï¼ˆæ¨èï¼Œæœ€å…ˆè¿›ï¼‰
trainer=SimNPO

# GradAscentï¼ˆæœ€ç®€å•ï¼ŒåŸºçº¿ï¼‰
trainer=GradAscent

# GradDiffï¼ˆSimNPO çš„åŸºç±»ï¼‰
trainer=GradDiff

# å…¶ä»–æ–¹æ³•
trainer=NPO / DPO / RMU / UNDIAL / CEU
```

### æ›´æ¢æ•°æ®é›†

```bash
# æ–¹å¼ 1: ä¿®æ”¹ split
forget_split=forget01  # 1% / 5% / 10%
retain_split=retain99  # 99% / 95% / 90%

# æ–¹å¼ 2: åˆ›å»ºæ–°å®éªŒé…ç½®
experiment=unlearn/my_dataset/default
```

### æ›´æ¢è¯„ä»·æŒ‡æ ‡

```bash
# ä½¿ç”¨ä¸åŒçš„è¯„ä¼°é…ç½®
eval=my_custom_eval

# æˆ–ä¿®æ”¹ç°æœ‰é…ç½®
# ç¼–è¾‘ configs/eval/tofu.yaml
```

## ğŸ“Š è®­ç»ƒæµç¨‹å¯è§†åŒ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. å‘½ä»¤è¡Œå¯åŠ¨                                            â”‚
â”‚    CUDA_VISIBLE_DEVICES=4 python src/train.py ...       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Hydra é…ç½®åˆå¹¶                                        â”‚
â”‚    åŸºç¡€é…ç½® + å®éªŒé…ç½® + å‘½ä»¤è¡Œå‚æ•°                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åŠ è½½æ¨¡å‹ (get_model)                                  â”‚
â”‚    model, tokenizer = get_model(cfg.model)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åŠ è½½æ•°æ® (get_data)                                   â”‚
â”‚    {"train": ForgetRetainDataset, "eval": QADataset}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. åˆå§‹åŒ– Trainer (load_trainer)                         â”‚
â”‚    trainer = SimNPO(...)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. è®­ç»ƒå¾ªç¯ (trainer.train)                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ for batch in dataloader:                        â”‚  â”‚
â”‚    â”‚   loss = compute_loss(model, batch)            â”‚  â”‚
â”‚    â”‚   â”œâ”€ forget_loss (æ¢¯åº¦ä¸Šå‡)                     â”‚  â”‚
â”‚    â”‚   â””â”€ retain_loss (æ­£å¸¸è®­ç»ƒ)                     â”‚  â”‚
â”‚    â”‚   loss.backward()                               â”‚  â”‚
â”‚    â”‚   optimizer.step()                              â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. ä¿å­˜æ¨¡å‹                                              â”‚
â”‚    trainer.save_model(output_dir)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. è¯„ä¼° (trainer.evaluate)                               â”‚
â”‚    è®¡ç®— Forget Quality (FQ) å’Œ Model Utility (MU)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” å…³é”®ä»£ç ç‰‡æ®µ

### 1. æŸå¤±è®¡ç®—ï¼ˆSimNPO.compute_lossï¼‰

```python
# === Forget æŸå¤± ===
forget_loss, _ = compute_batch_nll(model, forget_inputs)
forget_loss = forget_loss / loss_mask.sum(-1)  # å½’ä¸€åŒ–
forget_loss = forget_loss - self.delta          # åº”ç”¨åç§»
forget_loss = -F.logsigmoid(self.beta * forget_loss).mean() * 2 / self.beta

# === Retain æŸå¤± ===
retain_loss = self.compute_retain_loss(model, retain_inputs)

# === ç»„åˆ ===
loss = self.gamma * forget_loss + self.alpha * retain_loss
```

### 2. æ•°æ®é‡‡æ ·ï¼ˆForgetRetainDataset.__getitem__ï¼‰

```python
if self.anchor == "forget":
    # æŒ‰é¡ºåºè®¿é—® forgetï¼Œéšæœºé‡‡æ · retain
    item["forget"] = self.forget[idx]
    retain_idx = torch.randint(0, len(self.retain), (1,)).item()
    item["retain"] = self.retain[retain_idx]
```

### 3. é…ç½®åŠ è½½ï¼ˆHydraï¼‰

```python
@hydra.main(config_path="../configs", config_name="unlearn.yaml")
def main(cfg: DictConfig):
    # cfg å·²ç»åˆå¹¶äº†æ‰€æœ‰é…ç½®ï¼š
    # - configs/unlearn.yaml (åŸºç¡€)
    # - configs/experiment/unlearn/tofu/default.yaml (å®éªŒ)
    # - å‘½ä»¤è¡Œå‚æ•° (è¦†ç›–)
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é¦–æ¬¡è¿è¡Œå»ºè®®

```bash
# ä½¿ç”¨å°æ•°æ®é›†å¿«é€Ÿæµ‹è¯•
forget_split=forget01
retain_split=retain99
trainer.args.num_train_epochs=5
+trainer.args.eval_steps=10
+trainer.args.save_steps=10
```

### 2. ç”Ÿäº§ç¯å¢ƒå»ºè®®

```bash
# ä½¿ç”¨æ ‡å‡†é…ç½®
forget_split=forget10
retain_split=retain90
trainer.args.num_train_epochs=20
trainer.args.learning_rate=5e-5
+trainer.args.eval_steps=100
+trainer.args.save_steps=100
```

### 3. è°ƒè¯•å»ºè®®

```bash
# å¯ç”¨å®Œæ•´é”™è¯¯ä¿¡æ¯
HYDRA_FULL_ERROR=1

# ä½¿ç”¨å• GPU
CUDA_VISIBLE_DEVICES=0

# å¢åŠ æ—¥å¿—é¢‘ç‡
trainer.args.logging_steps=1
```

## ğŸ“– ç›¸å…³æ–‡æ¡£

- **è®­ç»ƒå…¥å£**: `src/train.py`ï¼ˆå·²æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼‰
- **SimNPO ç®—æ³•**: `src/trainer/unlearn/simnpo.py`ï¼ˆå·²æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼‰
- **GradDiff åŸºç±»**: `src/trainer/unlearn/grad_diff.py`ï¼ˆå·²æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼‰
- **ç»„åˆæ•°æ®é›†**: `src/data/unlearn.py`ï¼ˆå·²æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼‰
- **å®Œæ•´æŒ‡å—**: `UNLEARNING_GUIDE_CN.md`ï¼ˆæ–°å¢ï¼ŒåŒ…å«æ‰€æœ‰ç»†èŠ‚ï¼‰

## âœ… å®Œæˆæ¸…å•

- [x] `src/train.py` - è®­ç»ƒå…¥å£æ³¨é‡Š
- [x] `src/trainer/unlearn/simnpo.py` - SimNPO ç®—æ³•æ³¨é‡Š
- [x] `src/trainer/unlearn/grad_diff.py` - GradDiff åŸºç±»æ³¨é‡Š
- [x] `src/data/unlearn.py` - ForgetRetainDataset æ³¨é‡Š
- [x] `UNLEARNING_GUIDE_CN.md` - å®Œæ•´ä¸­æ–‡æŒ‡å—
- [x] `ä»£ç æ³¨é‡Šæ€»ç»“.md` - æœ¬æ–‡æ¡£

---

**æ³¨é‡Šç‰ˆæœ¬**: v1.0  
**å®Œæˆæ—¥æœŸ**: 2026-02-02  
**æ³¨é‡Šè¯­è¨€**: ç®€ä½“ä¸­æ–‡  
**æ³¨é‡Šè¦†ç›–ç‡**: æ ¸å¿ƒæ–‡ä»¶ 100%
