# OpenUnlearning é¡¹ç›®æ¶æ„è¯¦è§£

## ğŸ“ æ•´ä½“æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OpenUnlearning æ¶æ„                          â”‚
â”‚              "Registry Pattern + Hydra Config"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨å…¥å£å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚  train.py    â”‚              â”‚   eval.py   â”‚                â”‚
â”‚  â”‚  (è®­ç»ƒ/é—å¿˜)  â”‚              â”‚  (è¯„ä¼°)      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                              â”‚
          â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç»„ä»¶æ³¨å†Œè¡¨å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Trainer  â”‚  â”‚ Dataset â”‚  â”‚ Evaluatorâ”‚  â”‚  Model   â”‚        â”‚
â”‚  â”‚ Registry â”‚  â”‚ Registryâ”‚  â”‚ Registry â”‚  â”‚ Registry â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚            â”‚              â”‚              â”‚              â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”        â”‚
â”‚  â”‚        ç»Ÿä¸€åŠ è½½å‡½æ•° (load_* / get_*)                â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                              â”‚
          â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®ç°å±‚                                      â”‚
â”‚  Trainers:        Datasets:        Evaluators:    Models:       â”‚
â”‚  â€¢ GradAscent     â€¢ QADataset      â€¢ TOFU        â€¢ Llama       â”‚
â”‚  â€¢ GradDiff       â€¢ Pretraining    â€¢ MUSE        â€¢ Phi         â”‚
â”‚  â€¢ NPO/DPO        â€¢ ForgetRetain   â€¢ WMDP        â€¢ Gemma       â”‚
â”‚  â€¢ RMU/UNDIAL     â€¢ ...            â€¢ Metrics     â€¢ ...         â”‚
â”‚  â€¢ ...                            (MIA, etc.)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                              â”‚
          â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é…ç½®å±‚ (Hydra)                             â”‚
â”‚  â€¢ configs/trainer/*.yaml     (è®­ç»ƒå™¨é…ç½®)                      â”‚
â”‚  â€¢ configs/data/datasets/*.yaml (æ•°æ®é›†é…ç½®)                    â”‚
â”‚  â€¢ configs/model/*.yaml       (æ¨¡å‹é…ç½®)                        â”‚
â”‚  â€¢ configs/experiment/*.yaml  (å®éªŒé…ç½®)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ç›®å½•ç»“æ„è¯¦è§£

### æ ¹ç›®å½•æ–‡ä»¶

| æ–‡ä»¶ | ä½œç”¨ |
|------|------|
| `README.md` | é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼ŒåŒ…å«å¿«é€Ÿå¼€å§‹ã€ç»„ä»¶ä»‹ç»ç­‰ |
| `setup.py` | Python åŒ…å®‰è£…é…ç½®ï¼Œå®šä¹‰åŒ…åã€ç‰ˆæœ¬ã€ä¾èµ– |
| `requirements.txt` | Python ä¾èµ–åˆ—è¡¨ï¼ˆtransformers, torch, hydraç­‰ï¼‰ |
| `setup_data.py` | æ•°æ®ä¸‹è½½è„šæœ¬ï¼Œä» HuggingFace ä¸‹è½½è¯„ä¼°æ•°æ® |
| `Makefile` | ä»£ç è´¨é‡æ£€æŸ¥å‘½ä»¤ï¼ˆruff format, ruff checkï¼‰ |
| `.pre-commit-config.yaml` | Git æäº¤å‰è‡ªåŠ¨æ£€æŸ¥é…ç½® |
| `LICENSE` | MIT è®¸å¯è¯ |

### æ ¸å¿ƒæºä»£ç ç›®å½•ï¼š`src/`

#### `src/train.py` - è®­ç»ƒå…¥å£
- **ä½œç”¨**ï¼šè®­ç»ƒå’Œé—å¿˜çš„ä¸»å…¥å£æ–‡ä»¶
- **åŠŸèƒ½**ï¼š
  - ä½¿ç”¨ Hydra åŠ è½½é…ç½®
  - åŠ è½½æ¨¡å‹ã€æ•°æ®é›†ã€è®­ç»ƒå™¨
  - æ‰§è¡Œè®­ç»ƒ/é—å¿˜æµç¨‹
  - æ”¯æŒè®­ç»ƒä¸­è¯„ä¼°

#### `src/eval.py` - è¯„ä¼°å…¥å£
- **ä½œç”¨**ï¼šæ¨¡å‹è¯„ä¼°çš„ä¸»å…¥å£æ–‡ä»¶
- **åŠŸèƒ½**ï¼š
  - åŠ è½½æ¨¡å‹å’Œè¯„ä¼°å™¨
  - æ‰§è¡Œå„ç§è¯„ä¼°æŒ‡æ ‡è®¡ç®—
  - æ”¯æŒå¤šä¸ªåŸºå‡†æµ‹è¯•ï¼ˆTOFU, MUSE, WMDPï¼‰

#### `src/model/` - æ¨¡å‹ç®¡ç†
```
model/
â”œâ”€â”€ __init__.py      # æ¨¡å‹æ³¨å†Œè¡¨å’ŒåŠ è½½å‡½æ•°
â””â”€â”€ probe.py         # ProbedLlamaForCausalLMï¼ˆå¸¦æ¢é’ˆçš„æ¨¡å‹ï¼‰
```

**å…³é”®åŠŸèƒ½**ï¼š
- `MODEL_REGISTRY`: æ¨¡å‹ç±»æ³¨å†Œè¡¨
- `get_model()`: æ ¹æ®é…ç½®åŠ è½½æ¨¡å‹å’Œ tokenizer
- æ”¯æŒ `AutoModelForCausalLM` å’Œè‡ªå®šä¹‰æ¨¡å‹

#### `src/data/` - æ•°æ®å¤„ç†
```
data/
â”œâ”€â”€ __init__.py      # æ•°æ®é›†æ³¨å†Œè¡¨å’ŒåŠ è½½å‡½æ•°
â”œâ”€â”€ qa.py            # QA æ•°æ®é›†ï¼ˆé—®ç­”æ ¼å¼ï¼‰
â”œâ”€â”€ pretraining.py   # é¢„è®­ç»ƒæ•°æ®é›†ï¼ˆæ–‡æœ¬ç”Ÿæˆï¼‰
â”œâ”€â”€ unlearn.py       # ForgetRetainDatasetï¼ˆé—å¿˜ä¸“ç”¨ï¼‰
â”œâ”€â”€ collators.py     # æ•°æ®æ•´ç†å™¨ï¼ˆæ‰¹å¤„ç†ï¼‰
â””â”€â”€ utils.py         # æ•°æ®å·¥å…·å‡½æ•°
```

**å…³é”®ç±»**ï¼š
- `QADataset`: é—®ç­”æ ¼å¼æ•°æ®é›†
- `PretrainingDataset`: é¢„è®­ç»ƒæ–‡æœ¬æ•°æ®é›†
- `ForgetRetainDataset`: ç»„åˆ forget å’Œ retain æ•°æ®é›†
- `DataCollatorForSupervisedDataset`: æ‰¹å¤„ç†æ•´ç†å™¨

#### `src/trainer/` - è®­ç»ƒå™¨å®ç°
```
trainer/
â”œâ”€â”€ __init__.py      # è®­ç»ƒå™¨æ³¨å†Œè¡¨å’ŒåŠ è½½å‡½æ•°
â”œâ”€â”€ base.py          # FinetuneTrainerï¼ˆåŸºç¡€è®­ç»ƒå™¨ï¼‰
â”œâ”€â”€ utils.py         # å·¥å…·å‡½æ•°ï¼ˆKLæ•£åº¦ã€DPO lossç­‰ï¼‰
â””â”€â”€ unlearn/         # é—å¿˜æ–¹æ³•å®ç°
    â”œâ”€â”€ base.py      # UnlearnTrainerï¼ˆé—å¿˜åŸºç±»ï¼‰
    â”œâ”€â”€ grad_ascent.py    # GradAscent æ–¹æ³•
    â”œâ”€â”€ grad_diff.py      # GradDiff æ–¹æ³•
    â”œâ”€â”€ npo.py            # NPO æ–¹æ³•
    â”œâ”€â”€ dpo.py            # DPO æ–¹æ³•
    â”œâ”€â”€ simnpo.py         # SimNPO æ–¹æ³•
    â”œâ”€â”€ rmu.py            # RMU æ–¹æ³•
    â”œâ”€â”€ undial.py         # UNDIAL æ–¹æ³•
    â”œâ”€â”€ ceu.py            # CEU æ–¹æ³•
    â”œâ”€â”€ satimp.py         # SatImp æ–¹æ³•
    â”œâ”€â”€ wga.py            # WGA æ–¹æ³•
    â””â”€â”€ pdu.py            # PDU æ–¹æ³•
```

**ç»§æ‰¿å…³ç³»**ï¼š
```
Trainer (HuggingFace)
    â”‚
    â”œâ”€ FinetuneTrainer
    â”‚       â”‚
    â”‚       â””â”€ UnlearnTrainer
    â”‚               â”‚
    â”‚               â”œâ”€ GradAscent
    â”‚               â”œâ”€ GradDiff
    â”‚               â”‚       â”œâ”€ NPO
    â”‚               â”‚       â”œâ”€ DPO
    â”‚               â”‚       â””â”€ SimNPO
    â”‚               â”œâ”€ RMU
    â”‚               â”œâ”€ UNDIAL
    â”‚               â””â”€ ...
```

#### `src/evals/` - è¯„ä¼°ç³»ç»Ÿ
```
evals/
â”œâ”€â”€ __init__.py      # è¯„ä¼°å™¨æ³¨å†Œè¡¨
â”œâ”€â”€ base.py          # Evaluator åŸºç±»
â”œâ”€â”€ tofu.py          # TOFU åŸºå‡†æµ‹è¯•
â”œâ”€â”€ muse.py          # MUSE åŸºå‡†æµ‹è¯•
â”œâ”€â”€ lm_eval.py       # lm-evaluation-harness é›†æˆ
â””â”€â”€ metrics/         # è¯„ä¼°æŒ‡æ ‡
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ base.py      # Metric åŸºç±»
    â”œâ”€â”€ memorization.py  # è®°å¿†åŒ–æŒ‡æ ‡
    â”œâ”€â”€ privacy.py       # éšç§æŒ‡æ ‡
    â”œâ”€â”€ utility.py       # æ•ˆç”¨æŒ‡æ ‡
    â””â”€â”€ mia/             # æˆå‘˜æ¨ç†æ”»å‡»
        â”œâ”€â”€ loss.py      # LOSS æ”»å‡»
        â”œâ”€â”€ zlib.py      # ZLib æ”»å‡»
        â”œâ”€â”€ gradnorm.py  # GradNorm æ”»å‡»
        â”œâ”€â”€ min_k.py     # MinK æ”»å‡»
        â””â”€â”€ ...
```

### é…ç½®æ–‡ä»¶ç›®å½•ï¼š`configs/`

#### `configs/hydra/` - Hydra é…ç½®
- `default.yaml`: Hydra é»˜è®¤é…ç½®ï¼ˆæ—¥å¿—ã€è¾“å‡ºç›®å½•ï¼‰
- `eval.yaml`: è¯„ä¼°ä¸“ç”¨ Hydra é…ç½®

#### `configs/model/` - æ¨¡å‹é…ç½®
æ¯ä¸ªæ¨¡å‹ä¸€ä¸ª YAML æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- `model_handler`: æ¨¡å‹ç±»å
- `model_args`: æ¨¡å‹åŠ è½½å‚æ•°ï¼ˆè·¯å¾„ã€ç²¾åº¦ç­‰ï¼‰
- `tokenizer_args`: Tokenizer å‚æ•°
- `template_args`: èŠå¤©æ¨¡æ¿å‚æ•°

**ç¤ºä¾‹æ¨¡å‹**ï¼š
- `Llama-3.2-1B-Instruct.yaml`
- `Llama-3.1-8B-Instruct.yaml`
- `Phi-3.5-mini-instruct.yaml`
- `Gemma-7b-it.yaml`

#### `configs/trainer/` - è®­ç»ƒå™¨é…ç½®
æ¯ä¸ªè®­ç»ƒå™¨ä¸€ä¸ª YAML æ–‡ä»¶ï¼š
- `handler`: è®­ç»ƒå™¨ç±»å
- `args`: HuggingFace TrainingArguments
- `method_args`: æ–¹æ³•ç‰¹å®šå‚æ•°

**ç¤ºä¾‹**ï¼š
- `GradAscent.yaml`
- `GradDiff.yaml`
- `DPO.yaml`
- `finetune.yaml` (åŸºç¡€é…ç½®)

#### `configs/experiment/` - å®éªŒé…ç½®
ç»„åˆå¤šä¸ªç»„ä»¶çš„å®Œæ•´å®éªŒé…ç½®ï¼š

```
experiment/
â”œâ”€â”€ unlearn/         # é—å¿˜å®éªŒ
â”‚   â”œâ”€â”€ tofu/
â”‚   â”‚   â””â”€â”€ default.yaml
â”‚   â””â”€â”€ muse/
â”‚       â””â”€â”€ default.yaml
â””â”€â”€ eval/            # è¯„ä¼°å®éªŒ
    â”œâ”€â”€ tofu/
    â”‚   â””â”€â”€ default.yaml
    â””â”€â”€ muse/
        â””â”€â”€ default.yaml
```

**å®éªŒé…ç½®ç»“æ„**ï¼š
```yaml
defaults:
  - override /model: Llama-3.2-1B-Instruct
  - override /trainer: GradAscent
  - override /data: unlearn
  - override /eval: tofu

# è¦†ç›–ç‰¹å®šå‚æ•°
model:
  model_args:
    pretrained_model_name_or_path: open-unlearning/tofu_Llama-3.2-1B-Instruct_full
```

#### `configs/accelerate/` - Accelerate é…ç½®
- `default_config.yaml`: åˆ†å¸ƒå¼è®­ç»ƒé…ç½®
- `zero_stage3_offload_config.json`: DeepSpeed ZeRO-3 é…ç½®

### è„šæœ¬ç›®å½•ï¼š`scripts/`

| è„šæœ¬ | ä½œç”¨ |
|------|------|
| `tofu_unlearn.sh` | TOFU åŸºå‡†æµ‹è¯•çš„æ‰¹é‡é—å¿˜å®éªŒ |
| `muse_unlearn.sh` | MUSE åŸºå‡†æµ‹è¯•çš„æ‰¹é‡é—å¿˜å®éªŒ |
| `tofu_finetune.sh` | TOFU æ¨¡å‹çš„å¾®è°ƒè„šæœ¬ |

### æ–‡æ¡£ç›®å½•ï¼š`docs/`

| æ–‡æ¡£ | å†…å®¹ |
|------|------|
| `components.md` | å¦‚ä½•æ·»åŠ æ–°ç»„ä»¶ï¼ˆè®­ç»ƒå™¨ã€æ•°æ®é›†ã€è¯„ä¼°å™¨ç­‰ï¼‰ |
| `evaluation.md` | è¯„ä¼°ç³»ç»Ÿå’ŒæŒ‡æ ‡è¯¦è§£ |
| `experiments.md` | å®éªŒè¿è¡ŒæŒ‡å— |
| `hydra.md` | Hydra é…ç½®ç®¡ç†æ•™ç¨‹ |
| `links.md` | ç›¸å…³è®ºæ–‡å’Œèµ„æºé“¾æ¥ |
| `repro.md` | å¯å¤ç°æ€§ç»“æœ |

### ç¤¾åŒºç›®å½•ï¼š`community/`

- `leaderboard.md`: æ–¹æ³•æ€§èƒ½æ’è¡Œæ¦œ
- `benchmarks/template/`: åŸºå‡†æµ‹è¯•æ¨¡æ¿
- `methods/`: ç¤¾åŒºè´¡çŒ®çš„æ–¹æ³•å®ç°

## ğŸ”„ æ•°æ®æµå’Œç»„ä»¶å…³ç³»

### è®­ç»ƒæµç¨‹

```
1. ç”¨æˆ·è¿è¡Œå‘½ä»¤
   python src/train.py experiment=unlearn/tofu/default trainer=GradAscent

2. Hydra åŠ è½½é…ç½®
   â””â”€ åˆå¹¶ defaults ä¸­çš„é…ç½®
   â””â”€ è¦†ç›–å‘½ä»¤è¡Œå‚æ•°

3. ç»„ä»¶åŠ è½½ï¼ˆæŒ‰é¡ºåºï¼‰
   â”œâ”€ get_model() â†’ ä» MODEL_REGISTRY åŠ è½½æ¨¡å‹
   â”œâ”€ get_data() â†’ ä» DATASET_REGISTRY åŠ è½½æ•°æ®é›†
   â”œâ”€ get_collators() â†’ ä» COLLATOR_REGISTRY åŠ è½½æ•´ç†å™¨
   â”œâ”€ get_evaluators() â†’ ä» EVALUATOR_REGISTRY åŠ è½½è¯„ä¼°å™¨
   â””â”€ load_trainer() â†’ ä» TRAINER_REGISTRY åŠ è½½è®­ç»ƒå™¨

4. æ‰§è¡Œè®­ç»ƒ
   â””â”€ trainer.train() â†’ è°ƒç”¨è®­ç»ƒå™¨çš„ compute_loss()
   â””â”€ trainer.evaluate() â†’ æ‰§è¡Œè¯„ä¼°ï¼ˆå¦‚æœé…ç½®äº†ï¼‰

5. ä¿å­˜ç»“æœ
   â””â”€ æ¨¡å‹ä¿å­˜åˆ° saves/unlearn/<task_name>/
   â””â”€ è¯„ä¼°ç»“æœä¿å­˜åˆ° saves/unlearn/<task_name>/evals/
```

### è¯„ä¼°æµç¨‹

```
1. ç”¨æˆ·è¿è¡Œå‘½ä»¤
   python src/eval.py experiment=eval/tofu/default model=Llama-3.2-1B-Instruct

2. Hydra åŠ è½½é…ç½®
   â””â”€ åŠ è½½è¯„ä¼°å®éªŒé…ç½®

3. ç»„ä»¶åŠ è½½
   â”œâ”€ get_model() â†’ åŠ è½½è¦è¯„ä¼°çš„æ¨¡å‹
   â””â”€ get_evaluators() â†’ åŠ è½½è¯„ä¼°å™¨ï¼ˆTOFU, MUSEç­‰ï¼‰

4. æ‰§è¡Œè¯„ä¼°
   â””â”€ evaluator.evaluate() â†’ è®¡ç®—å„ç§æŒ‡æ ‡
   â””â”€ ä¿å­˜ç»“æœåˆ°æŒ‡å®šç›®å½•
```

## ğŸ¯ æ ¸å¿ƒè®¾è®¡æ¨¡å¼

### 1. Registry Patternï¼ˆæ³¨å†Œè¡¨æ¨¡å¼ï¼‰

æ¯ä¸ªç»„ä»¶ç±»å‹éƒ½æœ‰æ³¨å†Œè¡¨ï¼š
- `TRAINER_REGISTRY`
- `DATASET_REGISTRY`
- `EVALUATOR_REGISTRY`
- `COLLATOR_REGISTRY`
- `MODEL_REGISTRY`

**ä¼˜åŠ¿**ï¼š
- è§£è€¦å®ç°å’Œé…ç½®
- æ˜“äºæ‰©å±•æ–°ç»„ä»¶
- ç±»å‹å®‰å…¨

### 2. Hydra é…ç½®ç®¡ç†

- ä½¿ç”¨ YAML æ–‡ä»¶ç»„ç»‡é…ç½®
- æ”¯æŒé…ç½®ç»§æ‰¿å’Œè¦†ç›–
- å‘½ä»¤è¡Œå‚æ•°è¦†ç›–
- åŠ¨æ€é…ç½®ç»„åˆ

### 3. ç»„ä»¶åŒ–è®¾è®¡

æ¯ä¸ªç»„ä»¶ï¼ˆè®­ç»ƒå™¨ã€æ•°æ®é›†ã€è¯„ä¼°å™¨ï¼‰éƒ½æ˜¯ç‹¬ç«‹çš„ï¼š
- å®ç° â†’ æ³¨å†Œ â†’ é…ç½® â†’ ä½¿ç”¨

## ğŸ“Š å…³é”®æ–‡ä»¶ä½œç”¨æ€»ç»“

### å…¥å£æ–‡ä»¶
- `src/train.py`: è®­ç»ƒ/é—å¿˜ä¸»ç¨‹åº
- `src/eval.py`: è¯„ä¼°ä¸»ç¨‹åº

### æ ¸å¿ƒæ¨¡å—
- `src/trainer/`: æ‰€æœ‰è®­ç»ƒå™¨å®ç°
- `src/data/`: æ•°æ®é›†å®ç°
- `src/evals/`: è¯„ä¼°ç³»ç»Ÿå®ç°
- `src/model/`: æ¨¡å‹åŠ è½½å’Œç®¡ç†

### é…ç½®ç³»ç»Ÿ
- `configs/experiment/`: å®éªŒé…ç½®
- `configs/trainer/`: è®­ç»ƒå™¨é…ç½®
- `configs/model/`: æ¨¡å‹é…ç½®

### å·¥å…·è„šæœ¬
- `setup_data.py`: æ•°æ®ä¸‹è½½
- `scripts/*.sh`: æ‰¹é‡å®éªŒè„šæœ¬

## ğŸš€ æ‰©å±•ç‚¹

### æ·»åŠ æ–°è®­ç»ƒå™¨
1. åœ¨ `src/trainer/unlearn/` å®ç°ç±»
2. åœ¨ `src/trainer/__init__.py` æ³¨å†Œ
3. åœ¨ `configs/trainer/` åˆ›å»ºé…ç½®

### æ·»åŠ æ–°æ•°æ®é›†
1. åœ¨ `src/data/` å®ç° Dataset ç±»
2. åœ¨ `src/data/__init__.py` æ³¨å†Œ
3. åœ¨ `configs/data/datasets/` åˆ›å»ºé…ç½®

### æ·»åŠ æ–°è¯„ä¼°æŒ‡æ ‡
1. åœ¨ `src/evals/metrics/` å®ç° Metric ç±»
2. åœ¨è¯„ä¼°å™¨ä¸­é›†æˆä½¿ç”¨

### æ·»åŠ æ–°åŸºå‡†æµ‹è¯•
1. åœ¨ `src/evals/` å®ç° Evaluator ç±»
2. åœ¨ `src/evals/__init__.py` æ³¨å†Œ
3. åœ¨ `configs/experiment/eval/` åˆ›å»ºé…ç½®

## ğŸ“ æ€»ç»“

OpenUnlearning é‡‡ç”¨**æ³¨å†Œè¡¨æ¨¡å¼ + Hydra é…ç½®ç®¡ç†**çš„æ¶æ„è®¾è®¡ï¼Œå®ç°äº†ï¼š

1. **é«˜åº¦æ¨¡å—åŒ–**ï¼šæ¯ä¸ªç»„ä»¶ç‹¬ç«‹å®ç°å’Œé…ç½®
2. **æ˜“äºæ‰©å±•**ï¼šæ·»åŠ æ–°ç»„ä»¶åªéœ€ä¸‰æ­¥ï¼ˆå®ç°â†’æ³¨å†Œâ†’é…ç½®ï¼‰
3. **é…ç½®é©±åŠ¨**ï¼šé€šè¿‡ YAML æ–‡ä»¶çµæ´»ç»„åˆå®éªŒ
4. **ç»Ÿä¸€æ¥å£**ï¼šæ‰€æœ‰ç»„ä»¶éµå¾ªç›¸åŒçš„åŠ è½½æ¨¡å¼

è¿™ç§è®¾è®¡ä½¿å¾—æ¡†æ¶æ—¢èƒ½æ”¯æŒå¤šç§æ–¹æ³•ã€æ•°æ®é›†å’Œè¯„ä¼°æŒ‡æ ‡ï¼Œåˆä¿æŒäº†ä»£ç çš„æ¸…æ™°å’Œå¯ç»´æŠ¤æ€§ã€‚
